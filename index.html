<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ERC-20 Token Lab</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/web3/1.10.0/web3.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0a0d14;
            --bg-secondary: #161b22;
            --bg-tertiary: #21262d;
            --border-primary: #30363d;
            --border-secondary: #21262d;
            --text-primary: #f0f6fc;
            --text-secondary: #8b949e;
            --text-accent: #58a6ff;
            --accent-primary: #238636;
            --accent-secondary: #1f6feb;
            --accent-danger: #da3633;
            --accent-warning: #fb8500;
            --surface-glass: rgba(22, 27, 34, 0.85);
            --shadow-elevation: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans', Helvetica, Arial, sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, #1a1f2e 100%);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Top Navigation Bar */
        .navbar {
            background: var(--surface-glass);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border-primary);
            padding: 16px 24px;
            position: sticky;
            top: 0;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
        }

        .navbar-left {
            display: flex;
            align-items: center;
            gap: 24px;
        }

        .menu-toggle {
            background: rgba(88, 166, 255, 0.1);
            border: 1px solid rgba(88, 166, 255, 0.2);
            border-radius: 8px;
            padding: 10px 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            color: var(--text-accent);
        }

        .menu-toggle:hover {
            background: rgba(88, 166, 255, 0.2);
            transform: translateY(-1px);
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 20px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .brand-icon {
            background: linear-gradient(135deg, var(--accent-secondary), var(--text-accent));
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            color: white;
        }

        .navbar-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .balance-display {
            background: linear-gradient(135deg, var(--accent-secondary) 0%, var(--text-accent) 100%);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 12px rgba(88, 166, 255, 0.3);
            min-width: 120px;
            justify-content: center;
        }

        .profile-button {
            position: relative;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-primary);
            border-radius: 8px;
            padding: 8px 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--text-primary);
        }

        .profile-button:hover {
            border-color: var(--text-accent);
            background: rgba(88, 166, 255, 0.1);
        }

        .profile-avatar {
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, var(--accent-primary), #2ea043);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            color: white;
        }

        .connect-button {
            background: linear-gradient(135deg, var(--accent-primary) 0%, #2ea043 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 4px 12px rgba(35, 134, 54, 0.3);
        }

        .connect-button:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 16px rgba(35, 134, 54, 0.4);
        }

        .connect-button:disabled {
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            left: -380px;
            top: 0;
            width: 380px;
            height: 100vh;
            background: var(--surface-glass);
            backdrop-filter: blur(20px);
            border-right: 1px solid var(--border-primary);
            transition: left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 999;
            overflow-y: auto;
            box-shadow: 8px 0 32px rgba(0, 0, 0, 0.3);
        }

        .sidebar.open {
            left: 0;
        }

        .sidebar-header {
            padding: 32px 24px 24px;
            border-bottom: 1px solid var(--border-primary);
        }

        .sidebar-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .sidebar-subtitle {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .nav-section {
            padding: 24px 0;
        }

        .nav-section-title {
            color: var(--text-secondary);
            font-size: 11px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            padding: 0 24px 12px;
            margin-bottom: 8px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 12px 24px;
            color: var(--text-secondary);
            text-decoration: none;
            transition: all 0.2s ease;
            cursor: pointer;
            border-left: 3px solid transparent;
        }

        .nav-item:hover {
            background: rgba(88, 166, 255, 0.08);
            color: var(--text-accent);
            border-left-color: rgba(88, 166, 255, 0.3);
        }

        .nav-item.active {
            background: rgba(88, 166, 255, 0.12);
            color: var(--text-accent);
            border-left-color: var(--text-accent);
            font-weight: 600;
        }

        .nav-icon {
            width: 20px;
            height: 20px;
            margin-right: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .nav-text {
            flex: 1;
            font-size: 14px;
        }

        .nav-badge {
            background: var(--accent-warning);
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 700;
            text-transform: uppercase;
        }

        .nav-badge.danger {
            background: var(--accent-danger);
        }

        /* Profile Dropdown */
        .profile-dropdown {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            width: 320px;
            background: var(--surface-glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-primary);
            border-radius: 12px;
            box-shadow: var(--shadow-elevation);
            display: none;
            z-index: 1001;
        }

        .profile-dropdown.open {
            display: block;
            animation: slideDown 0.2s ease;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-8px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .profile-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-primary);
        }

        .profile-user {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }

        .profile-user-avatar {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--accent-primary), #2ea043);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            color: white;
        }

        .profile-user-info h4 {
            color: var(--text-primary);
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .profile-user-info p {
            color: var(--text-secondary);
            font-size: 12px;
        }

        .profile-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .stat-box {
            background: rgba(13, 17, 23, 0.6);
            border: 1px solid var(--border-secondary);
            border-radius: 8px;
            padding: 12px;
            text-align: center;
        }

        .stat-value {
            color: var(--text-accent);
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .contract-details {
            padding: 20px;
        }

        .contract-details h5 {
            color: var(--text-primary);
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            padding: 8px 12px;
            background: rgba(13, 17, 23, 0.4);
            border-radius: 6px;
        }

        .detail-row:last-child {
            margin-bottom: 0;
        }

        .detail-label {
            color: var(--text-secondary);
            font-size: 12px;
            font-weight: 500;
        }

        .detail-value {
            color: var(--text-primary);
            font-size: 12px;
            font-weight: 600;
            font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, monospace;
        }

        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 10px;
            font-weight: 700;
            text-transform: uppercase;
        }

        .status-active {
            background: rgba(35, 134, 54, 0.2);
            color: #2ea043;
        }

        .status-paused {
            background: rgba(218, 54, 51, 0.2);
            color: var(--accent-danger);
        }

        .status-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: currentColor;
        }

        /* Overlay */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(1, 4, 9, 0.75);
            backdrop-filter: blur(2px);
            display: none;
            z-index: 998;
        }

        .overlay.show {
            display: block;
        }

        /* Main Content */
        .main-content {
            padding: 40px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .content-card {
            background: var(--surface-glass);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-primary);
            border-radius: 16px;
            padding: 40px;
            margin-bottom: 24px;
            box-shadow: var(--shadow-elevation);
        }

        .page-header {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 12px;
        }

        .page-title {
            font-size: 32px;
            font-weight: 800;
            color: var(--text-primary);
        }

        .page-subtitle {
            color: var(--text-secondary);
            font-size: 18px;
            margin-bottom: 32px;
            line-height: 1.5;
        }

        /* Function Sections */
        .function-section {
            display: none;
        }

        .function-section.active {
            display: block;
        }

        .welcome-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 24px;
            margin-top: 40px;
        }

        .feature-card {
            background: rgba(13, 17, 23, 0.6);
            border: 1px solid var(--border-secondary);
            border-radius: 12px;
            padding: 24px;
            transition: all 0.3s ease;
        }

        .feature-card:hover {
            border-color: var(--text-accent);
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(88, 166, 255, 0.15);
        }

        .feature-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--accent-secondary), var(--text-accent));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            margin-bottom: 16px;
        }

        .feature-title {
            color: var(--text-primary);
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .feature-description {
            color: var(--text-secondary);
            font-size: 14px;
            line-height: 1.5;
        }

        .function-alert {
            padding: 16px 20px;
            border-radius: 10px;
            margin-bottom: 24px;
            border-left: 4px solid;
        }

        .function-alert.info {
            background: rgba(88, 166, 255, 0.1);
            border-color: var(--text-accent);
            color: var(--text-accent);
        }

        .function-alert.warning {
            background: rgba(251, 133, 0, 0.1);
            border-color: var(--accent-warning);
            color: var(--accent-warning);
        }

        .function-alert.danger {
            background: rgba(218, 54, 51, 0.1);
            border-color: var(--accent-danger);
            color: var(--accent-danger);
        }

        .form-group {
            margin-bottom: 24px;
        }

        .form-label {
            display: block;
            color: var(--text-primary);
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .form-input, .form-select {
            width: 100%;
            background: rgba(13, 17, 23, 0.8);
            border: 2px solid var(--border-primary);
            border-radius: 8px;
            padding: 12px 16px;
            color: var(--text-primary);
            font-size: 14px;
            transition: all 0.2s ease;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: var(--text-accent);
            box-shadow: 0 0 0 3px rgba(88, 166, 255, 0.1);
        }

        .form-input::placeholder {
            color: var(--text-secondary);
        }

        .button-group {
            display: flex;
            gap: 16px;
            margin-top: 32px;
        }

        .btn {
            flex: 1;
            padding: 14px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-secondary), var(--text-accent));
            color: white;
            box-shadow: 0 4px 12px rgba(88, 166, 255, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 16px rgba(88, 166, 255, 0.4);
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--accent-danger), #f85149);
            color: white;
            box-shadow: 0 4px 12px rgba(218, 54, 51, 0.3);
        }

        .btn-danger:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 16px rgba(218, 54, 51, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--accent-primary), #2ea043);
            color: white;
            box-shadow: 0 4px 12px rgba(35, 134, 54, 0.3);
        }

        .btn-success:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 16px rgba(35, 134, 54, 0.4);
        }

        .btn:disabled {
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .status-banner {
            padding: 16px 20px;
            border-radius: 10px;
            margin: 20px 0;
            font-weight: 500;
        }

        .status-banner.success {
            background: rgba(35, 134, 54, 0.15);
            color: #2ea043;
            border: 1px solid rgba(35, 134, 54, 0.3);
        }

        .status-banner.error {
            background: rgba(218, 54, 51, 0.15);
            color: var(--accent-danger);
            border: 1px solid rgba(218, 54, 51, 0.3);
        }

        .status-banner.info {
            background: rgba(88, 166, 255, 0.15);
            color: var(--text-accent);
            border: 1px solid rgba(88, 166, 255, 0.3);
        }

        .contract-status-section {
            text-align: center;
            padding: 24px;
            background: rgba(13, 17, 23, 0.4);
            border-radius: 10px;
            margin: 24px 0;
        }

        .contract-status-title {
            color: var(--text-secondary);
            font-size: 14px;
            margin-bottom: 12px;
        }

        .contract-status-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 700;
            text-transform: uppercase;
        }

        .contract-status-badge.active {
            background: rgba(35, 134, 54, 0.2);
            color: #2ea043;
        }

        .contract-status-badge.paused {
            background: rgba(218, 54, 51, 0.2);
            color: var(--accent-danger);
        }

        /* Network Selector */
        .network-info {
            background: rgba(88, 166, 255, 0.1);
            border: 1px solid rgba(88, 166, 255, 0.3);
            border-radius: 8px;
            padding: 12px 16px;
            margin-bottom: 24px;
            font-size: 14px;
            color: var(--text-accent);
        }

        .contract-address {
            background: rgba(13, 17, 23, 0.4);
            border: 1px solid var(--border-primary);
            border-radius: 8px;
            padding: 12px 16px;
            margin-bottom: 24px;
            font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, monospace;
            font-size: 12px;
            color: var(--text-secondary);
            word-break: break-all;
        }

        /* Minter Management Section */
        .minter-list {
            margin-top: 24px;
            border: 1px solid var(--border-primary);
            border-radius: 8px;
            overflow: hidden;
        }

        .minter-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 16px;
            border-bottom: 1px solid var(--border-primary);
            background: rgba(13, 17, 23, 0.4);
        }

        .minter-item:last-child {
            border-bottom: none;
        }

        .minter-address {
            font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, monospace;
            font-size: 12px;
        }

        .minter-actions {
            display: flex;
            gap: 8px;
        }

        .minter-badge {
            background: var(--accent-primary);
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 700;
        }

        .minter-badge.owner {
            background: var(--accent-secondary);
        }

        @media (max-width: 768px) {
            .main-content {
                padding: 20px;
            }
            
            .content-card {
                padding: 24px;
            }
            
            .sidebar {
                width: 320px;
                left: -320px;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .navbar {
                padding: 12px 16px;
            }
            
            .profile-dropdown {
                width: 280px;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="navbar-left">
            <button class="menu-toggle" id="menuToggle">
                <svg width="18" height="18" viewBox="0 0 18 18" fill="currentColor">
                    <path d="M2 4.5h14M2 9h14M2 13.5h14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
            </button>
            <div class="brand">
                <div class="brand-icon">⚡</div>
                <span>TokenLab</span>
            </div>
        </div>
        <div class="navbar-right">
            <div class="balance-display" id="balanceDisplay" style="display: none;">
                <span>💎</span>
                <span id="tokenBalance">0.000</span>
            </div>
            <div class="profile-button" id="profileButton" style="display: none;">
                <div class="profile-avatar">👤</div>
                <span>Profile</span>
                <svg width="12" height="12" viewBox="0 0 12 12" fill="currentColor" style="margin-left: 4px;">
                    <path d="M6 8l-3-3h6l-3 3z"/>
                </svg>
                
                <!-- Profile Dropdown -->
                <div class="profile-dropdown" id="profileDropdown">
                    <div class="profile-header">
                        <div class="profile-user">
                            <div class="profile-user-avatar">👤</div>
                            <div class="profile-user-info">
                                <h4>Wallet Connected</h4>
                                <p id="walletAddress">0x...</p>
                            </div>
                        </div>
                        <div class="profile-stats">
                            <div class="stat-box">
                                <div class="stat-value" id="userTokenBalance">0.000</div>
                                <div class="stat-label">Your Balance</div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-value" id="totalTokenSupply">0.000</div>
                                <div class="stat-label">Total Supply</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="contract-details">
                        <h5>
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                <path d="M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0zM6.5 5a.5.5 0 0 0-.5.5v5a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-5a.5.5 0 0 0-.5-.5h-3z"/>
                            </svg>
                            Contract Information
                        </h5>
                        <div class="detail-row">
                            <span class="detail-label">Token Name</span>
                            <span class="detail-value" id="contractTokenName">Loading...</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Symbol</span>
                            <span class="detail-value" id="contractTokenSymbol">Loading...</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Decimals</span>
                            <span class="detail-value" id="contractDecimals">18</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Contract Owner</span>
                            <span class="detail-value" id="contractOwnerAddress">Loading...</span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Your Role</span>
                            <span class="status-indicator" id="userRoleStatus">
                                <span class="status-dot"></span>
                                Loading...
                            </span>
                        </div>
                        <div class="detail-row">
                            <span class="detail-label">Status</span>
                            <span class="status-indicator" id="contractStatus">
                                <span class="status-dot"></span>
                                Loading...
                            </span>
                        </div>
                    </div>
                </div>
            </div>
            <button class="connect-button" id="connectButton">Connect Wallet</button>
        </div>
    </nav>

    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h2 class="sidebar-title">ERC-20 Token Lab</h2>
            <p class="sidebar-subtitle">Token Lab Menu</p>
        </div>
        
        <nav class="nav-section">
            <div class="nav-section-title">Overview</div>
            <div class="nav-item active" onclick="showSection('dashboard')">
                <div class="nav-icon">🏠</div>
                <span class="nav-text">Dashboard</span>
            </div>
        </nav>

        <nav class="nav-section">
            <div class="nav-section-title">Token Operations</div>
            <div class="nav-item" onclick="showSection('mint')">
                <div class="nav-icon">🪙</div>
                <span class="nav-text">Mint Tokens</span>
                <span class="nav-badge">MINTER</span>
            </div>
            <div class="nav-item" onclick="showSection('transfer')">
                <div class="nav-icon">💸</div>
                <span class="nav-text">Transfer Tokens</span>
            </div>
            <div class="nav-item" onclick="showSection('burn')">
                <div class="nav-icon">🔥</div>
                <span class="nav-text">Burn Tokens</span>
            </div>
        </nav>

        <nav class="nav-section">
            <div class="nav-section-title">Security & Control</div>
            <div class="nav-item" onclick="showSection('emergency')">
                <div class="nav-icon">🚨</div>
                <span class="nav-text">Emergency Controls</span>
                <span class="nav-badge danger">OWNER</span>
            </div>
            <div class="nav-item" onclick="showSection('minterManagement')">
                <div class="nav-icon">👥</div>
                <span class="nav-text">Minter Management</span>
                <span class="nav-badge">OWNER</span>
            </div>
            <div class="nav-item" onclick="showSection('adminManagement')">
                <div class="nav-icon">👑</div>
                <span class="nav-text">Admin Management</span>
                <span class="nav-badge">OWNER</span>
            </div>
        </nav>
    </aside>

    <!-- Overlay -->
    <div class="overlay" id="overlay"></div>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Status Message -->
        <div id="statusMessage" class="status-banner" style="display: none;"></div>

        <!-- Dashboard Section -->
        <section id="dashboard" class="content-card function-section active">
            <div class="page-header">
                <div class="page-title">🚀 Welcome To The ERC-20 Token Lab</div>
            </div>
            <p class="page-subtitle">
                Professional smart contract interface for token operations including minting, transfers, burning, and emergency controls. Built with industry-standard security practices.
            </p>
            
            <!-- Network and Contract Information -->
            <div class="network-info">
                <strong>🌐 Network Information:</strong> Make sure you're connected to the correct network in MetaMask. Current contract is deployed on your selected network.
            </div>
            
            <div class="contract-address">
                <strong>📜 Contract Address:</strong><br>
                <span id="displayContractAddress">0x4560c3d63187B47D346cb1F7731fB1484D969328</span>
            </div>
            
            <div class="welcome-grid">
                <div class="feature-card">
                    <div class="feature-icon">🪙</div>
                    <h3 class="feature-title">Token Minting</h3>
                    <p class="feature-description">Create new tokens with owner-controlled supply management and secure distribution mechanisms.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">💸</div>
                    <h3 class="feature-title">Secure Transfers</h3>
                    <p class="feature-description">Execute token transfers with pause-protected operations and real-time balance updates.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">🔥</div>
                    <h3 class="feature-title">Token Burning</h3>
                    <p class="feature-description">Reduce token supply through controlled burning mechanisms with permanent supply reduction.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">🚨</div>
                    <h3 class="feature-title">Emergency Controls</h3>
                    <p class="feature-description">Comprehensive security features including pause functionality for incident response and maintenance.</p>
                </div>
            </div>
        </section>

        <!-- Mint Tokens Section -->
        <section id="mint" class="content-card function-section">
            <div class="page-header">
                <div class="page-title">🪙 Mint Tokens</div>
            </div>
            <p class="page-subtitle">Create new tokens and distribute them to specified addresses with minter access control.</p>
            
            <div class="function-alert info">
                <strong>Minter Restricted Function:</strong> Only addresses with the minter role can mint new tokens. This ensures controlled token supply and prevents unauthorized inflation attacks.
            </div>
            
            <div class="form-group">
                <label class="form-label" for="mintRecipient">Recipient Address</label>
                <input type="text" id="mintRecipient" class="form-input" placeholder="Enter wallet address (0x...)" />
            </div>
            
            <div class="form-group">
                <label class="form-label" for="mintPreset">Quick Select Recipient</label>
                <select id="mintPreset" class="form-select">
                    <option value="">Choose from presets...</option>
                    <option value="self">My Wallet Address</option>
                    <option value="owner">Contract Owner Address</option>
                </select>
            </div>
            
            <div class="form-group">
                <label class="form-label" for="mintAmount">Amount to Mint</label>
                <input type="number" id="mintAmount" class="form-input" placeholder="Enter token amount (e.g., 100.5)" step="0.001" min="0" />
            </div>
            
            <div class="button-group">
                <button id="mintButton" class="btn btn-primary">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                        <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
                    </svg>
                    Mint Tokens
                </button>
            </div>
        </section>

        <!-- Transfer Tokens Section -->
        <section id="transfer" class="content-card function-section">
            <div class="page-header">
                <div class="page-title">💸 Transfer Tokens</div>
            </div>
            <p class="page-subtitle">Send your tokens to another wallet address with secure transfer validation.</p>
            
            <div class="function-alert info">
                <strong>Standard Transfer Operation:</strong> Send tokens from your wallet to any valid address. You can only transfer tokens you own.
            </div>
            
            <div class="form-group">
                <label class="form-label" for="transferRecipient">Recipient Address</label>
                <input type="text" id="transferRecipient" class="form-input" placeholder="Enter destination address (0x...)" />
            </div>
            
            <div class="form-group">
                <label class="form-label" for="transferAmount">Amount to Transfer</label>
                <input type="number" id="transferAmount" class="form-input" placeholder="Enter amount to send" step="0.001" min="0" />
            </div>
            
            <div class="button-group">
                <button id="transferButton" class="btn btn-primary">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
                    </svg>
                    Send Tokens
                </button>
            </div>
        </section>

        <!-- Burn Tokens Section -->
        <section id="burn" class="content-card function-section">
            <div class="page-header">
                <div class="page-title">🔥 Burn Tokens</div>
            </div>
            <p class="page-subtitle">Permanently destroy tokens from your balance to reduce the total supply.</p>
            
            <div class="function-alert danger">
                <strong>Irreversible Action:</strong> Burning tokens permanently removes them from circulation and reduces the total supply. This action cannot be undone.
            </div>
            
            <div class="form-group">
                <label class="form-label" for="burnAmount">Amount to Burn</label>
                <input type="number" id="burnAmount" class="form-input" placeholder="Enter amount to destroy permanently" step="0.001" min="0" />
            </div>
            
            <div class="button-group">
                <button id="burnButton" class="btn btn-danger">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>
                        <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>
                    </svg>
                    Burn Tokens
                </button>
            </div>
        </section>

        <!-- Emergency Controls Section -->
        <section id="emergency" class="content-card function-section">
            <div class="page-header">
                <div class="page-title">🚨 Emergency Controls</div>
            </div>
            <p class="page-subtitle">Emergency functions to pause or resume all contract operations during security incidents or maintenance.</p>
            
            <div class="function-alert warning">
                <strong>Owner Only Emergency Functions:</strong> These controls can halt all token operations contract-wide. Use during security incidents, upgrades, or maintenance periods.
            </div>
            
            <div class="contract-status-section">
                <div class="contract-status-title">Current Contract Status</div>
                <div class="contract-status-badge" id="emergencyStatus">
                    <span class="status-dot"></span>
                    Loading...
                </div>
            </div>
            
            <div class="button-group">
                <button id="pauseButton" class="btn btn-danger">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16zM7 6.5C7 6.776 6.776 7 6.5 7S6 6.776 6 6.5V5.5C6 5.224 6.224 5 6.5 5S7 5.224 7 5.5v1zM6.5 8.5c.276 0 .5.224.5.5v1c0 .276-.224.5-.5.5S6 10.276 6 10V9c0-.276.224-.5.5-.5z"/>
                    </svg>
                    Pause Contract
                </button>
                <button id="unpauseButton" class="btn btn-success">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16zM6.271 5.055a.5.5 0 0 1 .52.026L11 7.055a.5.5 0 0 1 0 .89L6.791 9.929a.5.5 0 0 1-.791-.389V5.604a.5.5 0 0 1 .271-.549z"/>
                    </svg>
                    Resume Contract
                </button>
            </div>
        </section>

        <!-- Minter Management Section -->
        <section id="minterManagement" class="content-card function-section">
            <div class="page-header">
                <div class="page-title">👥 Minter Management</div>
            </div>
            <p class="page-subtitle">Manage addresses that have permission to mint new tokens.</p>
            
            <div class="function-alert warning">
                <strong>Owner Only Function:</strong> Only the contract owner can add or remove minters. Minters can create new tokens but cannot pause the contract or manage other minters.
            </div>
            
            <div class="form-group">
                <label class="form-label" for="minterAddress">Address to Add/Remove</label>
                <input type="text" id="minterAddress" class="form-input" placeholder="Enter wallet address (0x...)" />
            </div>
            
            <div class="button-group">
                <button id="addMinterButton" class="btn btn-success">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                        <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
                    </svg>
                    Add Minter
                </button>
                <button id="removeMinterButton" class="btn btn-danger">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16zM4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
                    </svg>
                    Remove Minter
                </button>
            </div>
            
            <div class="minter-list" id="minterList">
                <div class="minter-item">
                    <span class="minter-address">Loading minters...</span>
                </div>
            </div>
        </section>

        <!-- Admin Management Section -->
        <section id="adminManagement" class="content-card function-section">
            <div class="page-header">
                <div class="page-title">👑 Admin Management</div>
            </div>
            <p class="page-subtitle">Grant or revoke full admin rights to team members.</p>
            
            <div class="function-alert warning">
                <strong>Owner Only Function:</strong> Only the contract owner can grant or revoke admin rights.
            </div>
            
            <div class="form-group">
                <label class="form-label" for="adminAddress">Address to Grant/Revoke Admin</label>
                <input type="text" id="adminAddress" class="form-input" placeholder="Enter wallet address (0x...)" />
            </div>
            
            <div class="button-group">
                <button id="grantAdminButton" class="btn btn-success">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                        <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
                    </svg>
                    Grant Admin Role
                </button>
                <button id="revokeAdminButton" class="btn btn-danger">
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16zM4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
                    </svg>
                    Revoke Admin Role
                </button>
            </div>
            
            <div class="minter-list" id="adminList">
                <div class="minter-item">
                    <span class="minter-address">Loading admins...</span>
                </div>
            </div>
        </section>
    </main>

    <script>
        // Global variables
        let web3;
        let contract;
        let userAccount;
        let isOwner = false;
        let isMinter = false;
        let isAdmin = false;

        // Contract configuration
        const contractAddress = "0x4560c3d63187B47D346cb1F7731fB1484D969328";
        
        // Display contract address on page
        document.getElementById('displayContractAddress').textContent = contractAddress;

        // Enhanced network configuration with multiple providers
        const networkConfig = {
            1: {
                name: 'Ethereum Mainnet',
                rpc: ['https://mainnet.infura.io/v3/YOUR_INFURA_KEY', 'https://eth-mainnet.alchemyapi.io/v2/YOUR_ALCHEMY_KEY'],
                explorer: 'https://etherscan.io',
                currency: 'ETH'
            },
            11155111: {
                name: 'Sepolia Testnet',
                rpc: ['https://sepolia.infura.io/v3/YOUR_INFURA_KEY', 'https://eth-sepolia.g.alchemy.com/v2/YOUR_ALCHEMY_KEY'],
                explorer: 'https://sepolia.etherscan.io',
                currency: 'SepoliaETH'
            },
            137: {
                name: 'Polygon Mainnet',
                rpc: ['https://polygon-mainnet.infura.io/v3/YOUR_INFURA_KEY', 'https://polygon-rpc.com'],
                explorer: 'https://polygonscan.com',
                currency: 'MATIC'
            },
            80001: {
                name: 'Mumbai Testnet',
                rpc: ['https://polygon-mumbai.infura.io/v3/YOUR_INFURA_KEY', 'https://rpc-mumbai.maticvigil.com'],
                explorer: 'https://mumbai.polygonscan.com',
                currency: 'MATIC'
            },
            56: {
                name: 'BSC Mainnet',
                rpc: ['https://bsc-dataseed.binance.org', 'https://bsc-dataseed1.defibit.io'],
                explorer: 'https://bscscan.com',
                currency: 'BNB'
            },
            97: {
                name: 'BSC Testnet',
                rpc: ['https://data-seed-prebsc-1-s1.binance.org:8545'],
                explorer: 'https://testnet.bscscan.com',
                currency: 'BNB'
            },
            43114: {
                name: 'Avalanche Mainnet',
                rpc: ['https://api.avax.network/ext/bc/C/rpc'],
                explorer: 'https://snowtrace.io',
                currency: 'AVAX'
            },
            43113: {
                name: 'Avalanche Fuji Testnet',
                rpc: ['https://api.avax-test.network/ext/bc/C/rpc'],
                explorer: 'https://testnet.snowtrace.io',
                currency: 'AVAX'
            },
            250: {
                name: 'Fantom Opera',
                rpc: ['https://rpc.ftm.tools'],
                explorer: 'https://ftmscan.com',
                currency: 'FTM'
            },
            4002: {
                name: 'Fantom Testnet',
                rpc: ['https://rpc.testnet.fantom.network'],
                explorer: 'https://testnet.ftmscan.com',
                currency: 'FTM'
            }
        };

        // Contract ABI from your provided contract
        const contractABI = [
            {
                "inputs": [
                    {
                        "internalType": "string",
                        "name": "name",
                        "type": "string"
                    },
                    {
                        "internalType": "string",
                        "name": "symbol",
                        "type": "string"
                    }
                ],
                "stateMutability": "nonpayable",
                "type": "constructor"
            },
            {
                "inputs": [],
                "name": "AccessControlBadConfirmation",
                "type": "error"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "account",
                        "type": "address"
                    },
                    {
                        "internalType": "bytes32",
                        "name": "neededRole",
                        "type": "bytes32"
                    }
                ],
                "name": "AccessControlUnauthorizedAccount",
                "type": "error"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "spender",
                        "type": "address"
                    },
                    {
                        "internalType": "uint256",
                        "name": "allowance",
                        "type": "uint256"
                    },
                    {
                        "internalType": "uint256",
                        "name": "needed",
                        "type": "uint256"
                    }
                ],
                "name": "ERC20InsufficientAllowance",
                "type": "error"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "sender",
                        "type": "address"
                    },
                    {
                        "internalType": "uint256",
                        "name": "balance",
                        "type": "uint256"
                    },
                    {
                        "internalType": "uint256",
                        "name": "needed",
                        "type": "uint256"
                    }
                ],
                "name": "ERC20InsufficientBalance",
                "type": "error"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "approver",
                        "type": "address"
                    }
                ],
                "name": "ERC20InvalidApprover",
                "type": "error"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "receiver",
                        "type": "address"
                    }
                ],
                "name": "ERC20InvalidReceiver",
                "type": "error"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "sender",
                        "type": "address"
                    }
                ],
                "name": "ERC20InvalidSender",
                "type": "error"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "spender",
                        "type": "address"
                    }
                ],
                "name": "ERC20InvalidSpender",
                "type": "error"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "owner",
                        "type": "address"
                    }
                ],
                "name": "OwnableInvalidOwner",
                "type": "error"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "account",
                        "type": "address"
                    }
                ],
                "name": "OwnableUnauthorizedAccount",
                "type": "error"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": true,
                        "internalType": "address",
                        "name": "owner",
                        "type": "address"
                    },
                    {
                        "indexed": true,
                        "internalType": "address",
                        "name": "spender",
                        "type": "address"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "value",
                        "type": "uint256"
                    }
                ],
                "name": "Approval",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": true,
                        "internalType": "address",
                        "name": "previousOwner",
                        "type": "address"
                    },
                    {
                        "indexed": true,
                        "internalType": "address",
                        "name": "newOwner",
                        "type": "address"
                    }
                ],
                "name": "OwnershipTransferred",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": false,
                        "internalType": "address",
                        "name": "account",
                        "type": "address"
                    }
                ],
                "name": "Paused",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": true,
                        "internalType": "bytes32",
                        "name": "role",
                        "type": "bytes32"
                    },
                    {
                        "indexed": true,
                        "internalType": "bytes32",
                        "name": "previousAdminRole",
                        "type": "bytes32"
                    },
                    {
                        "indexed": true,
                        "internalType": "bytes32",
                        "name": "newAdminRole",
                        "type": "bytes32"
                    }
                ],
                "name": "RoleAdminChanged",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": true,
                        "internalType": "bytes32",
                        "name": "role",
                        "type": "bytes32"
                    },
                    {
                        "indexed": true,
                        "internalType": "address",
                        "name": "account",
                        "type": "address"
                    },
                    {
                        "indexed": true,
                        "internalType": "address",
                        "name": "sender",
                        "type": "address"
                    }
                ],
                "name": "RoleGranted",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": true,
                        "internalType": "bytes32",
                        "name": "role",
                        "type": "bytes32"
                    },
                    {
                        "indexed": true,
                        "internalType": "address",
                        "name": "account",
                        "type": "address"
                    },
                    {
                        "indexed": true,
                        "internalType": "address",
                        "name": "sender",
                        "type": "address"
                    }
                ],
                "name": "RoleRevoked",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": true,
                        "internalType": "address",
                        "name": "from",
                        "type": "address"
                    },
                    {
                        "indexed": true,
                        "internalType": "address",
                        "name": "to",
                        "type": "address"
                    },
                    {
                        "indexed": false,
                        "internalType": "uint256",
                        "name": "value",
                        "type": "uint256"
                    }
                ],
                "name": "Transfer",
                "type": "event"
            },
            {
                "anonymous": false,
                "inputs": [
                    {
                        "indexed": false,
                        "internalType": "address",
                        "name": "account",
                        "type": "address"
                    }
                ],
                "name": "Unpaused",
                "type": "event"
            },
            {
                "inputs": [],
                "name": "DEFAULT_ADMIN_ROLE",
                "outputs": [
                    {
                        "internalType": "bytes32",
                        "name": "",
                        "type": "bytes32"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "MINTER_ROLE",
                "outputs": [
                    {
                        "internalType": "bytes32",
                        "name": "",
                        "type": "bytes32"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "PAUSER_ROLE",
                "outputs": [
                    {
                        "internalType": "bytes32",
                        "name": "",
                        "type": "bytes32"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "account",
                        "type": "address"
                    }
                ],
                "name": "addMinter",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "owner",
                        "type": "address"
                    },
                    {
                        "internalType": "address",
                        "name": "spender",
                        "type": "address"
                    }
                ],
                "name": "allowance",
                "outputs": [
                    {
                        "internalType": "uint256",
                        "name": "",
                        "type": "uint256"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "spender",
                        "type": "address"
                    },
                    {
                        "internalType": "uint256",
                        "name": "amount",
                        "type": "uint256"
                    }
                ],
                "name": "approve",
                "outputs": [
                    {
                        "internalType": "bool",
                        "name": "",
                        "type": "bool"
                    }
                ],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "account",
                        "type": "address"
                    }
                ],
                "name": "balanceOf",
                "outputs": [
                    {
                        "internalType": "uint256",
                        "name": "",
                        "type": "uint256"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "uint256",
                        "name": "amount",
                        "type": "uint256"
                    }
                ],
                "name": "burn",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "decimals",
                "outputs": [
                    {
                        "internalType": "uint8",
                        "name": "",
                        "type": "uint8"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "bytes32",
                        "name": "role",
                        "type": "bytes32"
                    }
                ],
                "name": "getRoleAdmin",
                "outputs": [
                    {
                        "internalType": "bytes32",
                        "name": "",
                        "type": "bytes32"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "bytes32",
                        "name": "role",
                        "type": "bytes32"
                    },
                    {
                        "internalType": "address",
                        "name": "account",
                        "type": "address"
                    }
                ],
                "name": "grantRole",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "bytes32",
                        "name": "role",
                        "type": "bytes32"
                    },
                    {
                        "internalType": "address",
                        "name": "account",
                        "type": "address"
                    }
                ],
                "name": "hasRole",
                "outputs": [
                    {
                        "internalType": "bool",
                        "name": "",
                        "type": "bool"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "account",
                        "type": "address"
                    }
                ],
                "name": "isMinter",
                "outputs": [
                    {
                        "internalType": "bool",
                        "name": "",
                        "type": "bool"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "to",
                        "type": "address"
                    },
                    {
                        "internalType": "uint256",
                        "name": "amount",
                        "type": "uint256"
                    }
                ],
                "name": "mint",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "name",
                "outputs": [
                    {
                        "internalType": "string",
                        "name": "",
                        "type": "string"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "owner",
                "outputs": [
                    {
                        "internalType": "address",
                        "name": "",
                        "type": "address"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "pause",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "paused",
                "outputs": [
                    {
                        "internalType": "bool",
                        "name": "",
                        "type": "bool"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "account",
                        "type": "address"
                    }
                ],
                "name": "removeMinter",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "renounceOwnership",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "bytes32",
                        "name": "role",
                        "type": "bytes32"
                    },
                    {
                        "internalType": "address",
                        "name": "callerConfirmation",
                        "type": "address"
                    }
                ],
                "name": "renounceRole",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "bytes32",
                        "name": "role",
                        "type": "bytes32"
                    },
                    {
                        "internalType": "address",
                        "name": "account",
                        "type": "address"
                    }
                ],
                "name": "revokeRole",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "bytes4",
                        "name": "interfaceId",
                        "type": "bytes4"
                    }
                ],
                "name": "supportsInterface",
                "outputs": [
                    {
                        "internalType": "bool",
                        "name": "",
                        "type": "bool"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "symbol",
                "outputs": [
                    {
                        "internalType": "string",
                        "name": "",
                        "type": "string"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "totalSupply",
                "outputs": [
                    {
                        "internalType": "uint256",
                        "name": "",
                        "type": "uint256"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "recipient",
                        "type": "address"
                    },
                    {
                        "internalType": "uint256",
                        "name": "amount",
                        "type": "uint256"
                    }
                ],
                "name": "transfer",
                "outputs": [
                    {
                        "internalType": "bool",
                        "name": "",
                        "type": "bool"
                    }
                ],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "sender",
                        "type": "address"
                    },
                    {
                        "internalType": "address",
                        "name": "recipient",
                        "type": "address"
                    },
                    {
                        "internalType": "uint256",
                        "name": "amount",
                        "type": "uint256"
                    }
                ],
                "name": "transferFrom",
                "outputs": [
                    {
                        "internalType": "bool",
                        "name": "",
                        "type": "bool"
                    }
                ],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "address",
                        "name": "newOwner",
                        "type": "address"
                    }
                ],
                "name": "transferOwnership",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "unpause",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            }
        ];

        // DOM Elements
        const menuToggle = document.getElementById('menuToggle');
        const sidebar = document.getElementById('sidebar');
        const overlay = document.getElementById('overlay');
        const profileButton = document.getElementById('profileButton');
        const profileDropdown = document.getElementById('profileDropdown');
        const connectButton = document.getElementById('connectButton');

        // Event Listeners
        menuToggle.addEventListener('click', toggleSidebar);
        overlay.addEventListener('click', closeSidebar);
        profileButton.addEventListener('click', toggleProfileDropdown);
        connectButton.addEventListener('click', connectWallet);

        // Close profile dropdown when clicking outside
        document.addEventListener('click', (e) => {
            if (profileButton && !profileButton.contains(e.target)) {
                profileDropdown.classList.remove('open');
            }
        });

        // Sidebar functionality
        function toggleSidebar() {
            sidebar.classList.toggle('open');
            overlay.classList.toggle('show');
        }

        function closeSidebar() {
            sidebar.classList.remove('open');
            overlay.classList.remove('show');
        }

        // Profile dropdown functionality
        function toggleProfileDropdown(e) {
            e.stopPropagation();
            profileDropdown.classList.toggle('open');
        }

        // Section navigation
        function showSection(sectionName) {
            // Hide all sections
            document.querySelectorAll('.function-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remove active class from all nav items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(sectionName).classList.add('active');
            
            // Add active class to clicked nav item
            event.target.closest('.nav-item').classList.add('active');
            
            // Close sidebar
            closeSidebar();
        }

        // Mint preset functionality
        document.getElementById('mintPreset').addEventListener('change', function() {
            const preset = this.value;
            const recipientInput = document.getElementById('mintRecipient');
            
            if (preset === 'self' && userAccount) {
                recipientInput.value = userAccount;
            } else if (preset === 'owner' && contract) {
                contract.methods.owner().call().then(owner => {
                    recipientInput.value = owner;
                }).catch(err => {
                    console.error('Error getting owner:', err);
                });
            }
        });

        // Improved wallet connection with better error handling
        async function connectWallet() {
            // Check if we're on mobile
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    
            if (typeof window.ethereum === 'undefined') {
                if (isMobile) {
                    // Redirect to MetaMask app on mobile
                    const metamaskDeepLink = `https://metamask.app.link/dapp/${window.location.host}${window.location.pathname}`;
                    showStatus('📱 Opening in MetaMask app...', 'info');
                    window.location.href = metamaskDeepLink;
                    return;
                } else {
                    showStatus('❌ MetaMask not detected! Please install MetaMask extension.', 'error');
                    return;
                }
            }

            try {
                showStatus('🔄 Connecting to MetaMask...', 'info');
                
                // Request accounts
                await window.ethereum.request({ method: 'eth_requestAccounts' });
                web3 = new Web3(window.ethereum);
                
                const accounts = await web3.eth.getAccounts();
                if (accounts.length === 0) {
                    showStatus('❌ No accounts found. Please unlock MetaMask.', 'error');
                    return;
                }
                
                userAccount = accounts[0];
                console.log('Connected account:', userAccount);

                // Get network information
                const networkId = await web3.eth.net.getId();
                const networkName = getNetworkName(networkId);
                console.log(`Connected to network: ${networkName} (ID: ${networkId})`);

                showStatus(`🌐 Connected to ${networkName}. Verifying contract...`, 'info');

                // Verify contract exists
                const code = await web3.eth.getCode(contractAddress);
                if (code === "0x" || code === "0x0") {
                    showStatus(`❌ Contract not found at ${contractAddress} on ${networkName}. Please check the address or switch networks.`, 'error');
                    return;
                }

                console.log('Contract code found, creating instance...');

                // Create contract instance
                contract = new web3.eth.Contract(contractABI, contractAddress);

                // Test contract connection by calling a view function
                try {
                    const tokenName = await contract.methods.name().call();
                    console.log('Contract connected successfully. Token name:', tokenName);
                } catch (contractError) {
                    console.error('Contract call failed:', contractError);
                    showStatus(`❌ Contract interaction failed: ${contractError.message}`, 'error');
                    return;
                }

                // Check owner and minter status
                try {
                    const ownerAddr = await contract.methods.owner().call();
                    isOwner = (ownerAddr.toLowerCase() === userAccount.toLowerCase());
                    
                    // Check if user is minter
                    const MINTER_ROLE = await contract.methods.MINTER_ROLE().call();
                    isMinter = await contract.methods.hasRole(MINTER_ROLE, userAccount).call();
                    
                    // Check if user is admin
                    const DEFAULT_ADMIN_ROLE = await contract.methods.DEFAULT_ADMIN_ROLE().call();
                    isAdmin = await contract.methods.hasRole(DEFAULT_ADMIN_ROLE, userAccount).call();
                    
                    console.log('Contract owner:', ownerAddr);
                    console.log('Is current user owner:', isOwner);
                    console.log('Is current user minter:', isMinter);
                    console.log('Is current user admin:', isAdmin);

                    if (isOwner) {
                        showStatus('✅ Connected successfully! You are the contract owner.', 'success');
                    } else if (isAdmin) {
                        showStatus('✅ Connected successfully! You have admin privileges.', 'success');
                    } else if (isMinter) {
                        showStatus('✅ Connected successfully! You have minter privileges.', 'success');
                    } else {
                        showStatus('✅ Connected successfully! (Note: You are not the owner or a minter)', 'info');
                    }
                } catch (ownerError) {
                    console.error('Error checking owner/minter status:', ownerError);
                    showStatus('⚠️ Connected but could not verify role status.', 'warning');
                }

                // Update UI
                connectButton.textContent = 'Connected ✅';
                connectButton.disabled = true;
                connectButton.style.background = 'var(--accent-primary)';
                
                document.getElementById('balanceDisplay').style.display = 'flex';
                profileButton.style.display = 'flex';

                // Load contract data
                await loadContractData();

            } catch (error) {
                console.error('Connection error:', error);
                let errorMessage = 'Unknown error occurred';
                
                if (error.code === 4001) {
                    errorMessage = 'Connection rejected by user';
                } else if (error.message) {
                    errorMessage = error.message;
                }
                
                showStatus(`❌ Connection failed: ${errorMessage}`, 'error');
            }
        }

        // Helper function to get network name
        function getNetworkName(networkId) {
            return networkConfig[networkId]?.name || `Unknown Network (ID: ${networkId})`;
        }

        // Network switching functionality
        async function switchNetwork(chainId) {
            try {
                await window.ethereum.request({
                    method: 'wallet_switchEthereumChain',
                    params: [{ chainId: web3.utils.toHex(chainId) }],
                });
            } catch (error) {
                // If network doesn't exist, add it
                if (error.code === 4902) {
                    const network = networkConfig[chainId];
                    if (network) {
                        await window.ethereum.request({
                            method: 'wallet_addEthereumChain',
                            params: [{
                                chainId: web3.utils.toHex(chainId),
                                chainName: network.name,
                                nativeCurrency: {
                                    name: network.currency,
                                    symbol: network.currency,
                                    decimals: 18,
                                },
                                rpcUrls: network.rpc,
                                blockExplorerUrls: [network.explorer],
                            }],
                        });
                    }
                }
                throw error;
            }
        }

        // Improved contract data loading
        async function loadContractData() {
            if (!contract || !userAccount) {
                console.error('Contract or user account not available');
                return;
            }

            try {
                showStatus('📊 Loading contract data...', 'info');

                const [name, symbol, decimals, totalSupply, balance, owner, paused, MINTER_ROLE, DEFAULT_ADMIN_ROLE] = await Promise.all([
                    contract.methods.name().call(),
                    contract.methods.symbol().call(), 
                    contract.methods.decimals().call(),
                    contract.methods.totalSupply().call(),
                    contract.methods.balanceOf(userAccount).call(),
                    contract.methods.owner().call(),
                    contract.methods.paused().call(),
                    contract.methods.MINTER_ROLE().call(),
                    contract.methods.DEFAULT_ADMIN_ROLE().call()
                ]);
                
                console.log('Contract data loaded:', { name, symbol, decimals, totalSupply, balance, owner, paused });
                
                // Convert decimals to number for calculations
                const decimalPlaces = parseInt(decimals);
                const divisor = Math.pow(10, decimalPlaces);
                
                // Format values using proper decimal places
                const formattedBalance = (parseFloat(balance) / divisor).toFixed(3);
                const formattedTotalSupply = (parseFloat(totalSupply) / divisor).toFixed(3);
                
                // Update all UI elements
                document.getElementById('tokenBalance').textContent = formattedBalance;
                document.getElementById('userTokenBalance').textContent = formattedBalance;
                document.getElementById('totalTokenSupply').textContent = formattedTotalSupply;
                document.getElementById('contractTokenName').textContent = name;
                document.getElementById('contractTokenSymbol').textContent = symbol;
                document.getElementById('contractDecimals').textContent = decimals;
                document.getElementById('walletAddress').textContent = 
                    userAccount.substring(0, 6) + '...' + userAccount.substring(38);
                document.getElementById('contractOwnerAddress').textContent = 
                    owner.substring(0, 6) + '...' + owner.substring(38);
                
                // Update role status
                updateRoleStatus();
                
                // Update status indicators
                updateStatusIndicators(paused);
                
                // Load minters if owner or admin
                if (isOwner || isAdmin) {
                    await loadMinters();
                    await loadAdmins();
                }
                
                showStatus('✅ Contract data loaded successfully!', 'success');
                
            } catch (error) {
                console.error('Error loading contract data:', error);
                showStatus(`❌ Error loading contract data: ${error.message}`, 'error');
            }
        }

        // Update role status display
        function updateRoleStatus() {
            const roleStatusEl = document.getElementById('userRoleStatus');
            
            if (isOwner) {
                roleStatusEl.innerHTML = `<span class="status-dot"></span>OWNER`;
                roleStatusEl.className = `status-indicator status-active`;
            } else if (isAdmin) {
                roleStatusEl.innerHTML = `<span class="status-dot"></span>ADMIN`;
                roleStatusEl.className = `status-indicator status-active`;
            } else if (isMinter) {
                roleStatusEl.innerHTML = `<span class="status-dot"></span>MINTER`;
                roleStatusEl.className = `status-indicator status-active`;
            } else {
                roleStatusEl.innerHTML = `<span class="status-dot"></span>STANDARD USER`;
                roleStatusEl.className = `status-indicator`;
            }
        }

        // Update status indicators
        function updateStatusIndicators(paused) {
            const statusText = paused ? 'PAUSED' : 'ACTIVE';
            const statusClass = paused ? 'status-paused' : 'status-active';
            
            const contractStatusEl = document.getElementById('contractStatus');
            const emergencyStatusEl = document.getElementById('emergencyStatus');
            
            if (contractStatusEl) {
                contractStatusEl.innerHTML = `<span class="status-dot"></span>${statusText}`;
                contractStatusEl.className = `status-indicator ${statusClass}`;
            }
            
            if (emergencyStatusEl) {
                emergencyStatusEl.innerHTML = `<span class="status-dot"></span>${statusText}`;
                emergencyStatusEl.className = `contract-status-badge ${statusClass}`;
            }
        }

        // Load list of minters
        async function loadMinters() {
            if (!contract || (!isOwner && !isAdmin)) return;
            
            try {
                const MINTER_ROLE = await contract.methods.MINTER_ROLE().call();
                const ownerAddr = await contract.methods.owner().call();
                
                // Get all Transfer events which might indicate minters (since we don't have direct access to all role members)
                // Note: This is a workaround - in a real app you might want to track minters separately
                const events = await contract.getPastEvents('RoleGranted', {
                    filter: {role: MINTER_ROLE},
                    fromBlock: 0,
                    toBlock: 'latest'
                });
                
                // Get unique addresses that have been granted the minter role
                const minterAddresses = [...new Set(events.map(e => e.returnValues.account))];
                
                // Add owner if they have minter role (which they should by default)
                const isOwnerMinter = await contract.methods.hasRole(MINTER_ROLE, ownerAddr).call();
                if (isOwnerMinter && !minterAddresses.includes(ownerAddr)) {
                    minterAddresses.push(ownerAddr);
                }
                
                // Display minters
                const minterListEl = document.getElementById('minterList');
                minterListEl.innerHTML = '';
                
                if (minterAddresses.length === 0) {
                    minterListEl.innerHTML = '<div class="minter-item"><span class="minter-address">No minters found</span></div>';
                    return;
                }
                
                for (const address of minterAddresses) {
                    const minterItem = document.createElement('div');
                    minterItem.className = 'minter-item';
                    
                    const isOwner = address.toLowerCase() === ownerAddr.toLowerCase();
                    const isCurrentUser = address.toLowerCase() === userAccount.toLowerCase();
                    
                    minterItem.innerHTML = `
                        <span class="minter-address">${address}</span>
                        <div class="minter-actions">
                            ${isOwner ? '<span class="minter-badge owner">OWNER</span>' : ''}
                            ${isCurrentUser ? '<span class="minter-badge">YOU</span>' : ''}
                            ${!isOwner ? `<button class="btn btn-danger btn-small" onclick="removeMinter('${address}')">Remove</button>` : ''}
                        </div>
                    `;
                    
                    minterListEl.appendChild(minterItem);
                }
                
            } catch (error) {
                console.error('Error loading minters:', error);
                showStatus(`❌ Error loading minters: ${error.message}`, 'error');
            }
        }

        // Load list of admins
        async function loadAdmins() {
            if (!contract || (!isOwner && !isAdmin)) return;

            try {
                const DEFAULT_ADMIN_ROLE = await contract.methods.DEFAULT_ADMIN_ROLE().call();
                const ownerAddr = await contract.methods.owner().call();
                
                // Get all RoleGranted events for admin role
                const events = await contract.getPastEvents('RoleGranted', {
                    filter: { role: DEFAULT_ADMIN_ROLE },
                    fromBlock: 0,
                    toBlock: 'latest'
                });

                // Get unique admin addresses
                const adminAddresses = [...new Set(events.map(e => e.returnValues.account))];
                
                // Add owner if they have admin role (which they should by default)
                const isOwnerAdmin = await contract.methods.hasRole(DEFAULT_ADMIN_ROLE, ownerAddr).call();
                if (isOwnerAdmin && !adminAddresses.includes(ownerAddr)) {
                    adminAddresses.push(ownerAddr);
                }

                // Display admins
                const adminListEl = document.getElementById('adminList');
                adminListEl.innerHTML = '';

                if (adminAddresses.length === 0) {
                    adminListEl.innerHTML = '<div class="minter-item"><span class="minter-address">No admins found</span></div>';
                    return;
                }

                for (const address of adminAddresses) {
                    const adminItem = document.createElement('div');
                    adminItem.className = 'minter-item';
                    
                    const isOwner = address.toLowerCase() === ownerAddr.toLowerCase();
                    const isCurrentUser = address.toLowerCase() === userAccount.toLowerCase();
                    
                    adminItem.innerHTML = `
                        <span class="minter-address">${address}</span>
                        <div class="minter-actions">
                            ${isOwner ? '<span class="minter-badge owner">OWNER</span>' : ''}
                            ${isCurrentUser ? '<span class="minter-badge">YOU</span>' : ''}
                            ${!isOwner ? `<button class="btn btn-danger btn-small" onclick="revokeAdminRole('${address}')">Revoke</button>` : ''}
                        </div>
                    `;
                    
                    adminListEl.appendChild(adminItem);
                }
            } catch (error) {
                console.error('Error loading admins:', error);
                showStatus(`❌ Error loading admins: ${error.message}`, 'error');
            }
        }

        // Simple Grant admin role function
        async function grantAdminRole() {
            try {
                if (!contract || !userAccount) {
                    showStatus('❌ Please connect your wallet first', 'error');
                    return;
                }

                if (!isOwner) {
                    showStatus('❌ Only the owner can grant admin rights', 'error');
                    return;
                }

                // Get address from input field
                const inputAddress = document.getElementById('adminAddress').value.trim();
        
                if (!inputAddress) {
                    showStatus('❌ Please enter an address', 'error');
                    return;
                }

                // Simple address validation - just check if it starts with 0x and has correct length
                if (!inputAddress.startsWith('0x') || inputAddress.length !== 42) {
                    showStatus('❌ Invalid address format. Must be 42 characters starting with 0x', 'error');
                    return;
                }

                showStatus('👑 Granting admin role... Please confirm in MetaMask', 'info');

                const DEFAULT_ADMIN_ROLE = await contract.methods.DEFAULT_ADMIN_ROLE().call();

                // Send transaction directly without gas estimation
                const result = await contract.methods.grantRole(DEFAULT_ADMIN_ROLE, inputAddress).send({
                    from: userAccount
                });

                console.log('Grant admin transaction result:', result);
        
                showStatus(`✅ Successfully granted admin role to ${inputAddress}!`, 'success');
                await loadAdmins();
        
                // Clear form
                document.getElementById('adminAddress').value = '';
        
            } catch (error) {
                console.error('Grant admin error:', error);
        
                if (error.code === 4001) {
                    showStatus('❌ Transaction rejected by user', 'error');
                } else {
                    showStatus(`❌ Grant admin failed: ${error.message}`, 'error');
                }
            }
        }

        // Revoke admin role
        async function revokeAdminRole(address = null) {
            if (!contract || !userAccount) {
                showStatus('❌ Please connect your wallet first', 'error');
                return;
            }

            if (!isOwner) {
                showStatus('❌ Only the owner can revoke admin rights', 'error');
                return;
            }

            // If address is not provided, get it from the input field
            if (!address) {
                address = document.getElementById('adminAddress').value.trim();
                if (!address) {
                    showStatus('❌ Please enter an address', 'error');
                    return;
                }
            }

            if (!web3.utils.isAddress(address)) {
                showStatus('❌ Invalid address format', 'error');
                return;
            }

            // Check if it's the owner (owner can't be removed as admin through this interface)
            const ownerAddr = await contract.methods.owner().call();
            if (address.toLowerCase() === ownerAddr.toLowerCase()) {
                showStatus('❌ Cannot remove owner as admin through this interface', 'error');
                return;
            }

            if (!confirm(`⚠️ Are you sure you want to revoke admin rights from ${address}?`)) {
                return;
            }

            try {
                showStatus('🔄 Revoking admin role...', 'info');
                
                const DEFAULT_ADMIN_ROLE = await contract.methods.DEFAULT_ADMIN_ROLE().call();
                
                // Check if actually an admin
                const isAdmin = await contract.methods.hasRole(DEFAULT_ADMIN_ROLE, address).call();
                if (!isAdmin) {
                    showStatus('⚠️ This address is not an admin', 'warning');
                    return;
                }

                showStatus('➖ Revoking admin role... Please confirm in MetaMask', 'info');

                const gasEstimate = await contract.methods.revokeRole(DEFAULT_ADMIN_ROLE, address).estimateGas({
                    from: userAccount
                });

                const result = await contract.methods.revokeRole(DEFAULT_ADMIN_ROLE, address).send({
                    from: userAccount,
                    gas: Math.floor(gasEstimate * 1.2)
                });

                console.log('Revoke admin transaction result:', result);
                
                showStatus(`✅ Successfully revoked admin role from ${address}!`, 'success');
                await loadAdmins();
                
                // Clear form if called from UI
                if (!address) {
                    document.getElementById('adminAddress').value = '';
                }
                
            } catch (error) {
                console.error('Revoke admin error:', error);
                let errorMessage = error.message;
                
                if (error.code === 4001) {
                    errorMessage = 'Transaction rejected by user';
                } else if (error.message.includes('revert')) {
                    errorMessage = 'Contract rejected the transaction (check permissions)';
                }
                
                showStatus(`❌ Revoke admin failed: ${errorMessage}`, 'error');
            }
        }

        // Improved minting function
        async function mintTokens() {
            if (!contract || !userAccount) {
                showStatus('❌ Please connect your wallet first', 'error');
                return;
            }

            const recipient = document.getElementById('mintRecipient').value.trim();
            const amount = document.getElementById('mintAmount').value.trim();

            if (!recipient || !amount) {
                showStatus('❌ Please enter both recipient address and amount', 'error');
                return;
            }

            // Validate recipient address
            if (!web3.utils.isAddress(recipient)) {
                showStatus('❌ Invalid recipient address format', 'error');
                return;
            }

            // Validate amount
            if (parseFloat(amount) <= 0) {
                showStatus('❌ Amount must be greater than 0', 'error');
                return;
            }

            // Minter check
            if (!isMinter && !isOwner && !isAdmin) {
                showStatus('❌ Only minters or admins can mint tokens', 'error');
                return;
            }

            try {
                showStatus('🔄 Preparing to mint tokens...', 'info');

                // Get decimals and calculate scaled amount
                const decimals = await contract.methods.decimals().call();
                const decimalPlaces = parseInt(decimals);
                const scaledAmount = web3.utils.toBN(Math.floor(parseFloat(amount) * Math.pow(10, decimalPlaces)));

                console.log(`Minting ${amount} tokens (${scaledAmount.toString()} wei) to ${recipient}`);

                showStatus('💫 Minting tokens... Please confirm in MetaMask', 'info');

                // Estimate gas first
                const gasEstimate = await contract.methods.mint(recipient, scaledAmount).estimateGas({
                    from: userAccount
                });

                console.log('Gas estimate:', gasEstimate);

                // Send transaction
                const result = await contract.methods.mint(recipient, scaledAmount).send({
                    from: userAccount,
                    gas: Math.floor(gasEstimate * 1.2) // Add 20% buffer
                });

                console.log('Mint transaction result:', result);

                showStatus(`✅ Successfully minted ${amount} tokens to ${recipient}!`, 'success');
                
                // Reload contract data
                await loadContractData();

                // Clear form
                document.getElementById('mintRecipient').value = '';
                document.getElementById('mintAmount').value = '';
                document.getElementById('mintPreset').value = '';

            } catch (error) {
                console.error('Minting error:', error);
                let errorMessage = error.message;
                
                if (error.code === 4001) {
                    errorMessage = 'Transaction rejected by user';
                } else if (error.message.includes('revert')) {
                    errorMessage = 'Contract rejected the transaction (check permissions and contract state)';
                }
                
                showStatus(`❌ Minting failed: ${errorMessage}`, 'error');
            }
        }

        // Improved transfer function
        async function transferTokens() {
            if (!contract || !userAccount) {
                showStatus('❌ Please connect your wallet first', 'error');
                return;
            }

            const recipient = document.getElementById('transferRecipient').value.trim();
            const amount = document.getElementById('transferAmount').value.trim();
            
            if (!recipient || !amount) {
                showStatus('❌ Please enter both recipient address and amount', 'error');
                return;
            }

            if (!web3.utils.isAddress(recipient)) {
                showStatus('❌ Invalid recipient address format', 'error');
                return;
            }

            if (parseFloat(amount) <= 0) {
                showStatus('❌ Amount must be greater than 0', 'error');
                return;
            }

            try {
                showStatus('🔄 Preparing transfer...', 'info');

                const decimals = await contract.methods.decimals().call();
                const decimalPlaces = parseInt(decimals);
                const scaledAmount = web3.utils.toBN(Math.floor(parseFloat(amount) * Math.pow(10, decimalPlaces)));

                // Check balance first
                const balance = await contract.methods.balanceOf(userAccount).call();
                if (web3.utils.toBN(balance).lt(scaledAmount)) {
                    showStatus('❌ Insufficient balance for transfer', 'error');
                    return;
                }

                showStatus('💫 Transferring tokens... Please confirm in MetaMask', 'info');

                const gasEstimate = await contract.methods.transfer(recipient, scaledAmount).estimateGas({
                    from: userAccount
                });

                const result = await contract.methods.transfer(recipient, scaledAmount).send({
                    from: userAccount,
                    gas: Math.floor(gasEstimate * 1.2)
                });

                console.log('Transfer transaction result:', result);
                
                showStatus(`✅ Successfully transferred ${amount} tokens to ${recipient}!`, 'success');
                await loadContractData();
                
                // Clear form
                document.getElementById('transferRecipient').value = '';
                document.getElementById('transferAmount').value = '';
                
            } catch (error) {
                console.error('Transfer error:', error);
                let errorMessage = error.message;
                
                if (error.code === 4001) {
                    errorMessage = 'Transaction rejected by user';
                } else if (error.message.includes('revert')) {
                    errorMessage = 'Contract rejected the transaction (check balance and contract state)';
                }
                
                showStatus(`❌ Transfer failed: ${errorMessage}`, 'error');
            }
        }

        // Improved burn function
        async function burnTokens() {
            if (!contract || !userAccount) {
                showStatus('❌ Please connect your wallet first', 'error');
                return;
            }

            const amount = document.getElementById('burnAmount').value.trim();
            
            if (!amount) {
                showStatus('❌ Please enter amount to burn', 'error');
                return;
            }

            if (parseFloat(amount) <= 0) {
                showStatus('❌ Amount must be greater than 0', 'error');
                return;
            }

            if (!confirm(`⚠️ Are you sure you want to permanently destroy ${amount} tokens? This action cannot be undone.`)) {
                return;
            }

            try {
                showStatus('🔄 Preparing to burn tokens...', 'info');

                const decimals = await contract.methods.decimals().call();
                const decimalPlaces = parseInt(decimals);
                const scaledAmount = web3.utils.toBN(Math.floor(parseFloat(amount) * Math.pow(10, decimalPlaces)));

                // Check balance first
                const balance = await contract.methods.balanceOf(userAccount).call();
                if (web3.utils.toBN(balance).lt(scaledAmount)) {
                    showStatus('❌ Insufficient balance to burn', 'error');
                    return;
                }

                showStatus('🔥 Burning tokens... Please confirm in MetaMask', 'info');

                const gasEstimate = await contract.methods.burn(scaledAmount).estimateGas({
                    from: userAccount
                });

                const result = await contract.methods.burn(scaledAmount).send({
                    from: userAccount,
                    gas: Math.floor(gasEstimate * 1.2)
                });

                console.log('Burn transaction result:', result);
                
                showStatus(`✅ Successfully burned ${amount} tokens!`, 'success');
                await loadContractData();
                
                // Clear form
                document.getElementById('burnAmount').value = '';
                
            } catch (error) {
                console.error('Burn error:', error);
                let errorMessage = error.message;
                
                if (error.code === 4001) {
                    errorMessage = 'Transaction rejected by user';
                } else if (error.message.includes('revert')) {
                    errorMessage = 'Contract rejected the transaction (check balance and contract state)';
                }
                
                showStatus(`❌ Burn failed: ${errorMessage}`, 'error');
            }
        }

        // Simple fix for pause function
        async function pauseContract() {
            if (!contract || !userAccount) {
                showStatus('⚠️ Please connect your wallet first', 'error');
                return;
            }

            // Simple check - allow owner OR admin
            if (!isOwner && !isAdmin) {
                showStatus('⚠️ Only the owner or admin can pause the contract', 'error');
                return;
            }

            try {
                showStatus('🔄 Preparing to pause contract...', 'info');

                const isPaused = await contract.methods.paused().call();
                if (isPaused) {
                    showStatus('⚠️ Contract is already paused', 'warning');
                    return;
                }

                showStatus('⏸️ Pausing contract... Please confirm in MetaMask', 'info');

                const result = await contract.methods.pause().send({
                    from: userAccount
                });

                showStatus('✅ Contract successfully paused!', 'success');
                await loadContractData();
                
            } catch (error) {
                console.error('Pause error:', error);
                showStatus(`❌ Pause failed: ${error.message}`, 'error');
            }
        }

        // Simple fix for unpause function  
        async function unpauseContract() {
            if (!contract || !userAccount) {
                showStatus('⚠️ Please connect your wallet first', 'error');
                return;
            }

            // Simple check - allow owner OR admin
            if (!isOwner && !isAdmin) {
                showStatus('⚠️ Only the owner or admin can unpause the contract', 'error');
                return;
            }

            try {
                showStatus('🔄 Preparing to resume contract...', 'info');

                const isPaused = await contract.methods.paused().call();
                if (!isPaused) {
                    showStatus('⚠️ Contract is already active', 'warning');
                    return;
                }

                showStatus('▶️ Resuming contract... Please confirm in MetaMask', 'info');

                const result = await contract.methods.unpause().send({
                    from: userAccount
                });

                showStatus('✅ Contract successfully resumed!', 'success');
                await loadContractData();
                
            } catch (error) {
                console.error('Unpause error:', error);
                showStatus(`❌ Unpause failed: ${error.message}`, 'error');
            }
        }

        // Add minter function
        async function addMinter() {
            if (!contract || !userAccount) {
                showStatus('❌ Please connect your wallet first', 'error');
                return;
            }

            if (!isOwner && !isAdmin) {
                showStatus('❌ Only the owner or admin can add minters', 'error');
                return;
            }

            const address = document.getElementById('minterAddress').value.trim();
            
            if (!address) {
                showStatus('❌ Please enter an address', 'error');
                return;
            }

            if (!web3.utils.isAddress(address)) {
                showStatus('❌ Invalid address format', 'error');
                return;
            }

            try {
                showStatus('🔄 Adding minter...', 'info');

                // Check if already a minter
                const isAlreadyMinter = await contract.methods.isMinter(address).call();
                if (isAlreadyMinter) {
                    showStatus('⚠️ This address is already a minter', 'warning');
                    return;
                }

                showStatus('➕ Adding minter... Please confirm in MetaMask', 'info');

                const gasEstimate = await contract.methods.addMinter(address).estimateGas({
                    from: userAccount
                });

                const result = await contract.methods.addMinter(address).send({
                    from: userAccount,
                    gas: Math.floor(gasEstimate * 1.2)
                });

                console.log('Add minter transaction result:', result);
                
                showStatus(`✅ Successfully added ${address} as a minter!`, 'success');
                await loadContractData();
                
                // Clear form
                document.getElementById('minterAddress').value = '';
                
            } catch (error) {
                console.error('Add minter error:', error);
                let errorMessage = error.message;
                
                if (error.code === 4001) {
                    errorMessage = 'Transaction rejected by user';
                } else if (error.message.includes('revert')) {
                    errorMessage = 'Contract rejected the transaction (check permissions)';
                }
                
                showStatus(`❌ Add minter failed: ${errorMessage}`, 'error');
            }
        }

        // Remove minter function
        async function removeMinter(address) {
            if (!contract || !userAccount) {
                showStatus('❌ Please connect your wallet first', 'error');
                return;
            }

            if (!isOwner && !isAdmin) {
                showStatus('❌ Only the owner or admin can remove minters', 'error');
                return;
            }

            if (!address) {
                showStatus('❌ Please enter an address', 'error');
                return;
            }

            if (!web3.utils.isAddress(address)) {
                showStatus('❌ Invalid address format', 'error');
                return;
            }

            // Check if it's the owner (owner can't be removed as minter through this interface)
            const ownerAddr = await contract.methods.owner().call();
            if (address.toLowerCase() === ownerAddr.toLowerCase()) {
                showStatus('❌ Cannot remove owner as minter through this interface', 'error');
                return;
            }

            if (!confirm(`⚠️ Are you sure you want to remove ${address} as a minter?`)) {
                return;
            }

            try {
                showStatus('🔄 Removing minter...', 'info');

                // Check if actually a minter
                const isMinter = await contract.methods.isMinter(address).call();
                if (!isMinter) {
                    showStatus('⚠️ This address is not a minter', 'warning');
                    return;
                }

                showStatus('➖ Removing minter... Please confirm in MetaMask', 'info');

                const gasEstimate = await contract.methods.removeMinter(address).estimateGas({
                    from: userAccount
                });

                const result = await contract.methods.removeMinter(address).send({
                    from: userAccount,
                    gas: Math.floor(gasEstimate * 1.2)
                });

                console.log('Remove minter transaction result:', result);
                
                showStatus(`✅ Successfully removed ${address} as a minter!`, 'success');
                await loadContractData();
                
            } catch (error) {
                console.error('Remove minter error:', error);
                let errorMessage = error.message;
                
                if (error.code === 4001) {
                    errorMessage = 'Transaction rejected by user';
                } else if (error.message.includes('revert')) {
                    errorMessage = 'Contract rejected the transaction (check permissions)';
                }
                
                showStatus(`❌ Remove minter failed: ${errorMessage}`, 'error');
            }
        }

        // Improved status message display
        function showStatus(message, type) {
            const statusDiv = document.getElementById('statusMessage');
            if (!statusDiv) return;
            
            statusDiv.textContent = message;
            statusDiv.className = `status-banner ${type}`;
            statusDiv.style.display = 'block';
            
            console.log(`[${type.toUpperCase()}] ${message}`);
            
            // Auto-hide success/info messages after 6 seconds
            if (type === 'success' || type === 'info') {
                setTimeout(() => {
                    statusDiv.style.display = 'none';
                }, 6000);
            }
            
            // Scroll to top to ensure message is visible
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Button event listeners
        document.getElementById('mintButton').addEventListener('click', mintTokens);
        document.getElementById('transferButton').addEventListener('click', transferTokens);
        document.getElementById('burnButton').addEventListener('click', burnTokens);
        document.getElementById('pauseButton').addEventListener('click', pauseContract);
        document.getElementById('unpauseButton').addEventListener('click', unpauseContract);
        document.getElementById('addMinterButton').addEventListener('click', addMinter);
        document.getElementById('removeMinterButton').addEventListener('click', () => {
            const address = document.getElementById('minterAddress').value.trim();
            if (address) {
                removeMinter(address);
            } else {
                showStatus('❌ Please enter an address to remove', 'error');
            }
        });
        document.getElementById('grantAdminButton').addEventListener('click', grantAdminRole);
        document.getElementById('revokeAdminButton').addEventListener('click', () => {
            const address = document.getElementById('adminAddress').value.trim();
            if (address) {
                revokeAdminRole(address);
            } else {
                showStatus('❌ Please enter an address to revoke', 'error');
            }
        });
        
        // Handle account changes
        if (window.ethereum) {
            window.ethereum.on('accountsChanged', function (accounts) {
                if (accounts.length === 0) {
                    // User disconnected
                    showStatus('👋 Wallet disconnected', 'info');
                    location.reload();
                } else if (accounts[0] !== userAccount) {
                    // User switched accounts
                    showStatus('🔄 Account changed. Reconnecting...', 'info');
                    location.reload();
                }
            });

            window.ethereum.on('chainChanged', function (chainId) {
                showStatus('🔄 Network changed. Reconnecting...', 'info');
                location.reload();
            });
        }

        // Auto-refresh contract data every 30 seconds when connected
        setInterval(async () => {
            if (userAccount && contract) {
                try {
                    await loadContractData();
                } catch (error) {
                    console.error('Auto-refresh error:', error);
                }
            }
        }, 30000);

        // Initialize page
        console.log('🚀 Token Lab initialized');
        console.log('📝 Contract Address:', contractAddress);
        
        // Check if wallet is already connected
        if (window.ethereum) {
            window.ethereum.request({ method: 'eth_accounts' })
                .then(accounts => {
                    if (accounts.length > 0) {
                        console.log('👛 Wallet already connected, auto-connecting...');
                        connectWallet();
                    }
                })
                .catch(err => console.error('Error checking existing connection:', err));
        }

        // Add input sanitizer for admin address field
        document.getElementById('adminAddress').addEventListener('input', function(e) {
            let value = e.target.value.trim();
            // Remove any whitespace
            value = value.replace(/\s/g, '');
            // Ensure lowercase after 0x
            if (value.startsWith('0x')) {
                value = '0x' + value.substring(2).toLowerCase();
            }
            e.target.value = value;
        });
    </script>
</body>
</html>
